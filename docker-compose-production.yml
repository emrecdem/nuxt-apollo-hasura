#  Run in production with
#  $ docker-compose -f docker-compose.yml -f docker-compose-production.yml up -d

version: '3.6'
services:
  app:
    network_mode: host
    build: ./
    container_name: erd-app
    working_dir: /usr/src/app
    depends_on:
      - postgres
      - hasura
    environment:
      HOST: 0.0.0.0
      NUXT_XENON_API_KEY: '${XENON_API_KEY}'

  upload_server:
    network_mode: host
    build: ./upload-server
    container_name: erd-upload-server
    command: [yarn, start]
    volumes:
      - /data/erd/files:/usr/src/app/cwl_files
    working_dir: /usr/src/app
